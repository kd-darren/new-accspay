(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8543c5b4"],{"3abd":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"account_recharge"},[a("div",{staticClass:"title"},[a("el-divider",{attrs:{direction:"vertical"}}),e._v("賬戶充值 ")],1),a("div",{staticClass:"account_balance"},[a("div",{staticClass:"el-icon-s-finance"},[e._v("賬戶余額")]),a("div",{staticClass:"balance"},[e._v("$ "+e._s(e.$store.state.user.wallet.balance.toFixed(2)))])]),a("div",{staticClass:"recharge_center"},[a("div",{staticClass:"recharge_title iconfont icon-chongzhichenggong"},[e._v("充值中心")]),a("el-form",{ref:"rechargeForm",attrs:{model:e.rechargeForm,"label-width":"1.2rem"}},[a("el-form-item",{attrs:{label:"充值金額:"}},[a("el-radio-group",{on:{change:e.setMoneyAmount},model:{value:e.moneyAmount,callback:function(t){e.moneyAmount=t},expression:"moneyAmount"}},[a("el-radio",{attrs:{label:"10",border:""}},[e._v("充值 $10")]),a("el-radio",{attrs:{label:"50",border:""}},[e._v("充值 $50")]),a("el-radio",{attrs:{label:"100",border:""}},[e._v("充值 $100")]),a("el-radio",{attrs:{label:"200",border:""}},[e._v("充值 $200")]),a("el-radio",{attrs:{label:"500",border:""}},[e._v("充值 $500")]),a("el-radio",{attrs:{label:"0",border:""}},[e._v("自定義")])],1)],1),a("el-form-item",{staticClass:"pay_methods",attrs:{label:"充值方式:"}},[a("el-radio-group",{on:{change:e.payMethodChange},model:{value:e.rechargeForm.paymentId,callback:function(t){e.$set(e.rechargeForm,"paymentId",t)},expression:"rechargeForm.paymentId"}},e._l(e.payMethodsList,(function(t,n){return a("el-radio",{key:n,attrs:{label:t.label,border:""}},[e._v(e._s(t.value)+" ")])})),1)],1),a("el-form-item",{attrs:{label:"充值金額:"}},[a("el-input-number",{attrs:{"controls-position":"right",min:.2,precision:2,disabled:0!=e.moneyAmount},model:{value:e.rechargeForm.targetAmount,callback:function(t){e.$set(e.rechargeForm,"targetAmount",t)},expression:"rechargeForm.targetAmount"}})],1),a("el-form-item",{attrs:{label:"應付金額:"}},[a("div",[e._v("充值金額："+e._s(parseFloat(e.rechargeForm.targetAmount).toFixed(2))+" 美元")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.calcLoading,expression:"calcLoading"}],staticClass:"calc_loading",attrs:{"element-loading-text":"計算中","element-loading-spinner":"el-icon-loading"}},[a("div",[e._v("手續費："+e._s(e.serviceFee.toFixed(2))+" 人民幣")]),a("div",[e._v("共計："),a("span",{staticClass:"total"},[e._v(e._s(e.total.toFixed(2))+" 人民幣")])])])]),a("el-form-item",[a("el-button",{attrs:{disabled:e.calcLoading&&e.submitLoading,loading:e.submitLoading,type:"primary"},on:{click:e.onSubmit}},[e._v("確認提交")])],1)],1)],1),a("el-dialog",{attrs:{visible:e.showPayDialog,width:"380px","before-close":e.closePay},on:{"update:visible":function(t){e.showPayDialog=t}}},[a("div",{staticClass:"online_pay"},[a("div",{staticClass:"online_pay_title"},[e._v("支付寶掃壹掃支付 "),a("span",[e._v(e._s(e.payForm.paymentAmount)+" 人民幣")])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.qrLoading,expression:"qrLoading"}],staticClass:"pay_code_img"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.payForm.codeUrl,expression:"!payForm.codeUrl"}],staticClass:"reset_code"},[a("el-link",{on:{click:e.resetGetCode}},[e._v("獲取二維碼失敗，請點擊刷新")])],1),a("vue-qr",{attrs:{text:e.payForm.codeUrl,size:260}})],1)])]),a("el-dialog",{attrs:{visible:e.showBankDialog,width:"550px","custom-class":"bankDialog"},on:{"update:visible":function(t){e.showBankDialog=t}}},[a("div",{staticClass:"bankinfo_title",domProps:{innerHTML:e._s(e.bankInfo.remark)}}),a("el-form",{ref:"bankForms",attrs:{rules:e.bankRules,model:e.bankForm,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"需支付: "}},[a("div",{staticClass:"bank-pay"},[e._v(e._s(e.total)+" 人民幣")])]),a("el-form-item",{attrs:{label:"支付校驗碼: "}},[a("div",[e._v(e._s(e.bankInfo.code)+" ")])]),a("el-form-item",{attrs:{label:"上傳憑證: ",prop:"sysAudit.auditCertificate"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.bankInfo.url,"show-file-list":!1,"on-success":e.handleAvatarSuccess,headers:e.bankInfo.headers}},[e.bankForm.sysAudit.auditCertificate?a("img",{staticClass:"avatar",attrs:{src:e.bankForm.sysAudit.auditCertificate}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{staticStyle:{padding:"10px 20px 20px"},attrs:{prop:"sysAudit.remark",label:"備註: "}},[a("el-input",{model:{value:e.bankForm.sysAudit.remark,callback:function(t){e.$set(e.bankForm.sysAudit,"remark",t)},expression:"bankForm.sysAudit.remark"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBank}},[e._v("提 交")]),a("el-button",{on:{click:e.resetBank}},[e._v("重 置")])],1)],1)],1)],1)},r=[],o=(a("d81d"),a("b0c0"),a("658f5")),s=a.n(o),i=a("0fea"),c={name:"account_recharge",components:{VueQr:s.a},data:function(){return{balance:11.1,moneyAmount:"10",rechargeForm:{type:"2",paymentId:1,targetAmount:10,targetCurrency:"USD",paymentAmount:"",paymentCurrency:"CNY"},serviceFee:0,noServiceFee:0,total:0,showPayDialog:!1,showBankDialog:!1,payForm:{id:null,paymentAmount:0,paymentCurrency:"CNY",targetCurrency:"",codeUrl:null},bankInfo:{code:"",remark:"請轉賬到中國銀行賬號 ，轉賬請備註校驗碼",headers:{Authorization:this.$store.getters.token},url:"//www.accspay.com/v1/common/upload"},bankForm:{id:null,paymentId:null,sysAudit:{auditCertificate:null,remark:null}},bankRules:{"sysAudit.auditCertificate":[{required:!0,message:"請上傳憑證",trigger:["blur","change"]}]},payMethodsList:[],currency_rate:6.3672,calcLoading:!0,timer:null,submitLoading:!1,qrLoading:!1}},created:function(){this.getPayMethodList(),this.rechargeCalc()},watch:{"rechargeForm.targetAmount":function(){this.rechargeCalc()}},methods:{getPayMethodList:function(){var e=this;Object(i["i"])().then((function(t){t.rows.map((function(t){e.payMethodsList.push({label:t.id,value:t.name})}))}))},payMethodChange:function(){this.rechargeCalc()},setMoneyAmount:function(e){this.rechargeForm.targetAmount=e<.2?.2:parseFloat(e)},rechargeCalc:function(){var e=this;this.calcLoading=!0,Object(i["j"])(this.rechargeForm).then((function(t){e.total=t.data.actualPaymentAmount,e.noServiceFee=t.data.paymentAmount,e.serviceFee=t.data.actualPaymentAmount-t.data.paymentAmount,e.calcLoading=!1}))},onSubmit:function(){var e=this,t={paymentAmount:this.noServiceFee,paymentCurrency:this.rechargeForm.paymentCurrency,targetCurrency:this.rechargeForm.targetCurrency};Object(i["r"])(t).then((function(t){1==e.rechargeForm.paymentId?(e.payForm.id=t.data.id,e.payForm.paymentCurrency=t.data.paymentCurrency,e.payForm.targetCurrency=t.data.targetCurrency,e.getPayInfo()):2==e.rechargeForm.paymentId&&(e.bankForm.id=t.data.id,e.bankForm.paymentId=e.rechargeForm.paymentId,e.bankTransfer())}))},getPayInfo:function(){var e=this;this.submitLoading=!0,Object(i["f"])(this.payForm.id).then((function(t){e.payForm.paymentAmount=t.data.paymentAmount,e.payForm.codeUrl=t.data.url,e.showPayDialog=!0,e.submitLoading=!1,e.qrLoading=!1,e.payForm.codeUrl&&(e.timer=setTimeout((function(){e.getPayStatus()}),3e3))}))},resetGetCode:function(){this.qrLoading=!0,this.getPayInfo()},getPayStatus:function(){var e=this;Object(i["g"])(this.payForm.id).then((function(t){1==t?(e.$message({showClose:!0,type:"success",message:"支付成功",customClass:"messageBuy"}),e.showPayDialog=!1,e.getWMoney()):e.timer=setTimeout((function(){e.getPayStatus()}),3e3)}))},closePay:function(){clearTimeout(this.timer),this.showPayDialog=!1,this.submitLoading=!1,this.qrLoading=!1},bankTransfer:function(){this.getBankTransferInfo(),this.getBankTransferCode(),this.bankForm.sysAudit.auditCertificate=null,this.bankForm.sysAudit.remark=null,this.showBankDialog=!0},getBankTransferInfo:function(){var e=this;Object(i["c"])().then((function(t){e.bankInfo.remark=t.data.remark,e.$refs.bankForms&&e.$refs.bankForms.resetFields()}))},getBankTransferCode:function(){var e=this;Object(i["b"])(this.bankForm.id).then((function(t){e.bankInfo.code=t.data.paymentAuthCode}))},handleAvatarSuccess:function(e){this.bankForm.sysAudit.auditCertificate=e.url},submitBank:function(){var e=this;this.$refs.bankForms.validate((function(t){t&&Object(i["s"])(e.bankForm).then((function(){e.$message({showClose:!0,type:"success",message:"提交成功，請等待審核",customClass:"messageBuy"}),e.showBankDialog=!1})).catch((function(){e.$message({showClose:!0,type:"success",message:"提交失敗",customClass:"messageBuy"})}))}))},resetBank:function(){this.$refs.bankForms.resetFields()},getWMoney:function(){var e=this;Object(i["o"])().then((function(t){e.wallet.balance=t.data.balance,e.wallet.currencyCode=t.data.currencyCode,e.$store.dispatch("SetWallet",e.wallet)}))}}},l=c,u=(a("9c8d"),a("2877")),m=Object(u["a"])(l,n,r,!1,null,null,null);t["default"]=m.exports},"9c8d":function(e,t,a){"use strict";a("ca28")},b0c0:function(e,t,a){var n=a("83ab"),r=a("5e77").EXISTS,o=a("e330"),s=a("9bf2").f,i=Function.prototype,c=o(i.toString),l=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=o(l.exec),m="name";n&&!r&&s(i,m,{configurable:!0,get:function(){try{return u(l,c(this))[1]}catch(e){return""}}})},ca28:function(e,t,a){}}]);